<?xml version="1.0" encoding="utf-8"?>
<html MadCap:check_list="Ran Smart Index" MadCap:timeEstimate="0" MadCap:priority="0" MadCap:status="In Progress" MadCap:lastBlockDepth="2" MadCap:lastHeight="2219" MadCap:lastWidth="686" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../../Resources/Stylesheets/ApteanOLH.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <head><title>EstablishSession (IAuthenticateOnyx)</title>
            <link href="../../Resources/Stylesheets/ApteanOLH.css" rel="stylesheet" type="text/css" />
        </head>
        <h5>
            <MadCap:keyword term="EstablishSession method;EstablishSession" />EstablishSession method</h5>
        <p>The EstablishSession method of the <a href="IAuthenticateOnyx_Interface.htm"><MadCap:keyword term="IAuthenticateOnyx" />IAuthenticateOnyx 
 interface</a> authenticates a user, maps the user to an Onyx user, initiates 
 a session, and provides a session ID.</p>
        <h3>Syntax</h3>
        <p class="BodyText" style="font-weight: bold;">IDL</p>
        <p Class="Code" class="code">HRESULT&#160;EstablishSession(</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;[in]&#160;const&#160;BSTR&#160;strOnyxUserName,&#160;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;[in]&#160;const&#160;BSTR&#160;strPassword,&#160;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;[in]&#160;const&#160;BSTR&#160;strApplicationName,&#160;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;[in]&#160;const&#160;BSTR&#160;strSourceName,&#160;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;[in]&#160;const&#160;BSTR&#160;strSiteID,&#160;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;[out,&#160;retval]&#160;BSTR&#160;*pstrSessionID);</p>
        <p class="BodyText" style="font-weight: bold;">
            IDL parameter descriptions
        </p>
        <p>strOnyxUserName</p>
        <p class="BodyTextIndent_1">[in] A string that contains an OEAS user name. The maximum 
 length is 10 characters.</p>
        <p>strPassword</p>
        <p class="BodyTextIndent_1">[in] A string that contains the user's password. The maximum 
 length is 20 characters.</p>
        <p>strApplicationName</p>
        <p class="BodyTextIndent_1">[in] A string that contains the application name.</p>
        <p>strSourceName</p>
        <p class="BodyTextIndent_1">[in] A string that contains the source name, which is a 
 client application.</p>
        <p>strSiteID</p>
        <p class="BodyTextIndent_1">[in] A string that contains the site ID.</p>
        <p>pstrSessionID</p>
        <p class="BodyTextIndent_1">[out, retval] A string containing the session ID. The session 
 ID is a GUID that identifies the session created by this method. The session 
 ID is required with each call to the Onyx Transaction Manager (OTM).</p>
        <p class="BodyText" style="font-weight: bold;">Visual Basic</p>
        <p Class="Code" class="code">Function&#160;EstablishSession(</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;strOnyxUserName&#160;As&#160;String,</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;strPassword&#160;As&#160;String,</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;strApplicationName&#160;As&#160;String,</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;strSourceName&#160;As&#160;String,</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;strSiteID&#160;As&#160;String)</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;As&#160;String</p>
        <p>
            Visual Basic parameter descriptions
        </p>
        <p>strOnyxUserName</p>
        <p class="BodyTextIndent_1">[in] A string that contains an OEAS user name. The maximum 
 length is 10 characters.</p>
        <p>strPassword</p>
        <p class="BodyTextIndent_1">[in] A string that contains the user's password. The maximum 
 length is 20 characters.</p>
        <p>strApplicationName</p>
        <p class="BodyTextIndent_1">[in] A string that contains the application name.</p>
        <p>strSourceName</p>
        <p class="BodyTextIndent_1">[in] A string that contains the source name, which is a 
 client application.</p>
        <p>strSiteID</p>
        <p class="BodyTextIndent_1">[in] A string that contains the site ID.</p>
        <p class="BodyText" style="font-weight: bold;">C#</p>
        <p>Use with the .NET <a href="Primary_interop_assembly.htm">primary interop 
 assembly</a> version of this component, OnyxAuthenticatePIA.</p>
        <p Class="Code" class="code">public&#160;string&#160;EstablishSession(</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;string&#160;strOnyxUserName,&#160;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;string&#160;strPassword,&#160;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;string&#160;strApplicationName,</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;string&#160;strSourceName,&#160;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;string&#160;strSiteID)</p>
        <p>
            C# parameter descriptions
        </p>
        <p>strOnyxUserName</p>
        <p class="BodyTextIndent_1">[in] A string that contains an OEAS user name. The maximum 
 length is 10 characters.</p>
        <p>strPassword</p>
        <p class="BodyTextIndent_1">[in] A string that contains the user's password. The maximum 
 length is 20 characters.</p>
        <p>strApplicationName</p>
        <p class="BodyTextIndent_1">[in] A string that contains the application name.</p>
        <p>strSourceName</p>
        <p class="BodyTextIndent_1">[in] A string that contains the source name, which is a 
 client application.</p>
        <p>strSiteID</p>
        <p class="BodyTextIndent_1">[in] A string that contains the site ID.</p>
        <h3>Return values</h3>
        <p>This method returns a string containing a session ID. The session ID 
 is a GUID that identifies the session created by this method. The session 
 ID is required with each call to the Onyx Transaction Manager (OTM).</p>
        <p>When called from a C++ client application, this method returns a standard 
 COM HRESULT or one of the custom <a href="Security_error_values.htm">security 
 error value</a> HRESULTS. When a Visual Basic client application calls 
 this method and an error occurs, the Err object specifies one of the decimal 
 <a href="Security_error_values.htm">security error values</a> and provides 
 a brief description of the error.</p>
        <h3>Remarks</h3>
        <p>Use the IAuthenticateOnyx::EstablishSession 
 method for users who did not use a Microsoft Windows login or anonymous 
 authentication to access the system. EstablishSession encrypts the <span style="font-style: italic;">strPassword</span> parameter and it is stored 
 as encrypted data. </p>
    </body>
</html>