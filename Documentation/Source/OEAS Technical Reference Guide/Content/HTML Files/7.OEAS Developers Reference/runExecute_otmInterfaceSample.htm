<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:check_list="Ran Smart Index" MadCap:timeEstimate="0" MadCap:priority="0" MadCap:status="In Progress" MadCap:lastBlockDepth="2" MadCap:lastHeight="1576" MadCap:lastWidth="694">
    <head>
        <link href="../../Resources/Stylesheets/ApteanOLH.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <head><title>runExecute (OTM Interface Sample)</title>
            <link href="../../Resources/Stylesheets/ApteanOLH.css" rel="stylesheet" type="text/css" />
        </head>
        <h6>
            <MadCap:keyword term="runExecute;OTM Interface Sample" />View execute code</h6>
        <p>This is the ASP code that runs in the sample. To actually run this code, 
 you need to install the sample and click the <a href="enterExecuteParams_otmInterfaceSample.htm">Run 
 Execute Code</a> button in the browser. This code performs the logical 
 object method call that is required to successfully insert a company record 
 from the client application.</p>
        <p><a href="enterExecuteParams_otmInterfaceSample.htm">Go to Run Execute 
 topic</a>
        </p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;otm</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;strparametersReturn</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;strApplicationName</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;strLogicalObjectName</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;strLogicalMethodName</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;strSessionId</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;strParamXML</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;strCustomDataXML</p>
        <p Class="Code" class="code">&#160;&#160;strApplicationName&#160;=&#160;Request.Form("applicationName")</p>
        <p Class="Code" class="code">&#160;&#160;strLogicalObjectName&#160;=&#160;Request.Form("logicalObjectName")</p>
        <p Class="Code" class="code">&#160;&#160;strLogicalMethodName&#160;=&#160;Request.Form("logicalMethodName")</p>
        <p Class="Code" class="code">&#160;&#160;strSessionId&#160;=&#160;Request.cookies("OnyxSessionId")</p>
        <p Class="Code" class="code">&#160;&#160;strParamXML&#160;=&#160;Request.Form("paramXML")</p>
        <p Class="Code" class="code">&#160;&#160;strCustomDataXML&#160;=&#160;Request.Form("customDataXML")</p>
        <p Class="Code" class="code">'&#160;Open&#160;the&#160;paramXML&#160;file</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;fso</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;xml_file</p>
        <p Class="Code" class="code">&#160;&#160;set&#160;fso&#160;=&#160;CreateObject("Scripting.FileSystemObject")</p>
        <p Class="Code" class="code">&#160;&#160;set&#160;xml_file&#160;=&#160;fso.OpenTextFile(&#160;"C:\Inetpub\wwwroot\SampleCode1\"&#160;&amp;&#160;strParamXML&#160;)</p>
        <p Class="Code" class="code">&#160;&#160;strParamXML&#160;=&#160;xml_file.ReadAll</p>
        <p Class="Code" class="code">&#160;&#160;set&#160;fso&#160;=&#160;nothing</p>
        <p Class="Code" class="code">&#160;&#160;set&#160;xml_file&#160;=&#160;nothing</p>
        <p Class="Code" class="code">'&#160;Comment&#160;out&#160;the&#160;following&#160;line&#160;and&#160;add&#160;your</p>
        <p Class="Code" class="code">'&#160;code&#160;for&#160;opening&#160;and&#160;reading&#160;a&#160;customDataXML</p>
        <p Class="Code" class="code">'&#160;file,&#160;if&#160;you&#160;customize&#160;the&#160;logical&#160;object&#160;method.</p>
        <p Class="Code" class="code">&#160;&#160;strCustomDataXML&#160;=&#160;""</p>
        <p Class="Code" class="code">'&#160;Create&#160;an&#160;OTM&#160;object</p>
        <p Class="Code" class="code">&#160;&#160;set&#160;otm&#160;=&#160;createobject("OnyxTransactionManager.TransactionManager")</p>
        <p Class="Code" class="code">&#160;&#160;strparametersReturn&#160;=&#160;otm.Execute(&#160;_</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;strApplicationName,&#160;_</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;strLogicalObjectName,&#160;_</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;strLogicalMethodName,&#160;_</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;strSessionId,&#160;_</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;strParamXML,&#160;_</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;strCustomDataXML&#160;_</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;)</p>
        <p Class="Code" class="code">&#160;</p>
        <p Class="Code" class="code">&#160;&#160;set&#160;otm&#160;=&#160;nothing</p>
        <p Class="Code" class="code">'&#160;Write&#160;an&#160;XML&#160;header&#160;pi</p>
        <p Class="Code" class="code">&#160;&#160;response.write(&#160;_&#160;"&lt;?xml&#160;version="&#160;_<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&amp;&#160;chr(34)&#160;_<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&amp;&#160;"&#160;1.0"&#160;_&#160;&amp;&#160;chr(34)&#160;_&#160;&amp;&#160;"&#160;?&gt;"&#160;_&#160;&amp;&#160;vbcrlf&#160;_&#160;)</p>
        <p Class="Code" class="code">'&#160;Write&#160;the&#160;XML</p>
        <p Class="Code" class="code">&#160;&#160;response.write(strparametersReturn)</p>
        <p Class="Code" class="code">&#160;&#160;response.end&#160;</p>
    </body>
</html>