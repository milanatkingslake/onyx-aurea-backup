<?xml version="1.0" encoding="utf-8"?>
<html MadCap:check_list="Ran Smart Index" MadCap:timeEstimate="0" MadCap:priority="0" MadCap:status="In Progress" MadCap:lastBlockDepth="6" MadCap:lastHeight="547.4567" MadCap:lastWidth="645" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../../Resources/TableStyles/Aptean_Note_Table_1.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../Resources/TableStyles/Aptean_Table_1.css" rel="stylesheet" MadCap:stylesheetType="table" />
    </head>
    <body>
        <head><title>Use of entity encoding</title>
            <link href="../../Resources/Stylesheets/ApteanOLH.css" rel="stylesheet" type="text/css" />
        </head>
        <h5>
            <MadCap:keyword term="entity;entity:Use;Use;Use:entity" />Use of entity encoding</h5>
        <p>You must use entity encoding for reserved XML characters in the run-time 
 XML. The script engine expects the run-time XML as a string within the 
 scriptSessionXml parameter of each of its methods. Like all COM step components, 
 OnyxScriptEngineStep expects a stepPackage structure as a parameter to 
 the IStep Execute method. The run time XML must not alter the structure 
 of the stepPackage in any way. The following table illustrates the encoding 
 scheme in the context of the stepPackage XML.</p>
        <table wrapperparagraphselector="P" style="width: 100%;border-spacing: 0px;margin-top: 14pt;border-spacing: 0px;mc-table-style: url('../../Resources/TableStyles/Aptean_Table_1.css');" cellspacing="0" width="100%" class="TableStyle-Aptean_Table_1">
            <col class="TableStyle-Aptean_Table_1-Column-Column1" />
            <col class="TableStyle-Aptean_Table_1-Column-Column1" />
            <thead>
                <tr class="TableStyle-Aptean_Table_1-Head-Header1">
                    <th class="TableStyle-Aptean_Table_1-HeadE-Column1-Header1">
                        <p class="TableHead" style="margin-bottom: 0;">Instead of structural markup...</p>
                    </th>
                    <th class="TableStyle-Aptean_Table_1-HeadD-Column1-Header1">
                        <p class="TableHead" style="margin-bottom: 0;">...use entity encoding</p>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Aptean_Table_1-Body-Body1">
                    <td style="width: 50%;padding-left: 2px;padding-top: 2px;padding-right: 2px;padding-bottom: 2px;" valign="top" width="50%" class="TableStyle-Aptean_Table_1-BodyB-Column1-Body1">
                        <p class="TableText">&lt;stepPackage&gt;</p>
                        <p class="TableText">&#160; &lt;context/&gt;</p>
                        <p class="TableText">&#160; &lt;parameters&gt;</p>
                        <p class="TableText">&#160; &lt;scriptSessionXml&gt;</p>
                        <p class="TableText">&#160; <span style="color: #FF0000;">&lt;root&gt;&lt;/root&gt;</span></p>
                        <p class="TableText">&#160; &lt;/scriptSessionXml&gt;</p>
                        <p class="TableText">&#160; &lt;/parameters&gt;</p>
                        <p class="TableText">&#160; &lt;returnXml/&gt;</p>
                        <p class="TableText" style="margin-bottom: 0;">&lt;/stepPackage&gt;</p>
                    </td>
                    <td style="width: 50%;padding-left: 2px;padding-top: 2px;padding-right: 2px;padding-bottom: 2px;" valign="top" width="50%" class="TableStyle-Aptean_Table_1-BodyA-Column1-Body1">
                        <p class="TableText">&lt;stepPackage&gt;</p>
                        <p class="TableText">&#160; &lt;context/&gt;</p>
                        <p class="TableText">&#160; &lt;parameters&gt;</p>
                        <p class="TableText">&#160; &lt;scriptSessionXml&gt;</p>
                        <p class="TableText">&#160; <span style="color: #FF0000;">&lt;root&gt;&lt;/root&gt;</span></p>
                        <p class="TableText">&#160; &lt;/scriptSessionXml&gt;</p>
                        <p class="TableText">&#160; &lt;/parameters&gt;</p>
                        <p class="TableText">&#160; &lt;returnXml/&gt;</p>
                        <p class="TableText" style="margin-bottom: 0;">&lt;/stepPackage&gt;</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <table style="mc-table-style: url('../../Resources/TableStyles/Aptean_Note_Table_1.css');width: 80%;" class="TableStyle-Aptean_Note_Table_1" cellspacing="2">
            <col style="width: 0.7cm;" class="TableStyle-Aptean_Note_Table_1-Column-Column1" />
            <col class="TableStyle-Aptean_Note_Table_1-Column-Column1" style="width: 15.50cm;" />
            <tbody>
                <tr class="TableStyle-Aptean_Note_Table_1-Body-Body1">
                    <td class="TableStyle-Aptean_Note_Table_1-BodyB-Column1-Body1" style="text-align: right;">
                        <p>
                            <img src="../../Resources/Images/Common/note_image.png" />
                        </p>
                    </td>
                    <td class="TableStyle-Aptean_Note_Table_1-BodyA-Column1-Body1">
                        <p class="TableText"><b>Note</b>: For markup, such as HTML strings, embedded within the run-time 
 XML, the ampersand character must be encoded as well (e.g. &amp; = &amp;amp;). 
 Thus "&lt;h1&gt;Hello&lt;/h1&gt;" becomes "&amp;amp;lt;h1&amp;amp;gt;Hello&amp;amp;lt;/h1&amp;amp;gt;".</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>In order to work with the run-time XML using 
 an MSXML DOM, the value of the scriptSessionXml parameter should be loaded 
 into a new DOM as a string. Onyx does not recommend using the same DOM 
 to parse the run-time XML as is used to construct the call to the Transaction 
 Manager or to process the return from the Transaction Manager. </p>
    </body>
</html>