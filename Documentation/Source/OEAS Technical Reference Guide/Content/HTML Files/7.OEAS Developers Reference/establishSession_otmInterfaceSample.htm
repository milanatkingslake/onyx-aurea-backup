<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:check_list="Ran Smart Index" MadCap:timeEstimate="0" MadCap:priority="0" MadCap:status="In Progress" MadCap:lastBlockDepth="2" MadCap:lastHeight="937" MadCap:lastWidth="1020">
    <head>
        <link href="../../Resources/Stylesheets/ApteanOLH.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <head><title>View Authentication Code (OTM Interface Sample)</title>
            <link href="../../Resources/Stylesheets/ApteanOLH.css" rel="stylesheet" type="text/css" />
        </head>
        <h6>
            <MadCap:keyword term="OTM Interface Sample;code;View" />View Authentication Code</h6>
        <p>This is the ASP code that runs in the sample. To actually run this code, 
 you need to install the sample and click the <a href="enterSessionParams_otmInterfaceSample.htm">Get 
 Session ID</a> button in the browser. This code performs the authentication 
 that is required before you can successfully insert a company record from 
 the client application.</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;objAuthenticate</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;strOnyxUserName</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;strPassword</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;strApplicationName</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;strSourceName</p>
        <p Class="Code" class="code">&#160;&#160;Dim&#160;strSiteID</p>
        <p Class="Code" class="code">&#160;&#160;strOnyxUserName&#160;=&#160;Request.Form("onyxUserName")</p>
        <p Class="Code" class="code">&#160;&#160;strPassword&#160;=&#160;Request.Form("password1")</p>
        <p Class="Code" class="code">&#160;&#160;strApplicationName&#160;=&#160;Request.Form("applicationName")</p>
        <p Class="Code" class="code">&#160;&#160;strSourceName&#160;=&#160;Request.Form("sourceName")</p>
        <p Class="Code" class="code">&#160;&#160;strSiteID&#160;=&#160;Request.Form("siteId")</p>
        <p Class="Code" class="code">&#160;&#160;Set&#160;objAuthenticate&#160;=&#160;CreateObject("OnyxAuthenticate.AuthenticateOnyx")</p>
        <p Class="Code" class="code">&#160;&#160;Response.Cookies("OnyxSessionId")&#160;=&#160;objAuthenticate.EstablishSession(&#160;_</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;strOnyxUserName,&#160;_</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;strPassword,&#160;_</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;strApplicationName,&#160;_</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;strSourceName,&#160;_</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;strSiteId&#160;_</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;)</p>
        <p Class="Code" class="code">&#160;&#160;set&#160;objAuthenticate&#160;=&#160;nothing</p>
        <p Class="Code" class="code">&#160;&#160;Response.Write("Your&#160;sessionId&#160;is&#160;stored&#160;in&#160;a&#160;cookie&#160;called&#160;"&#160;_</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&amp;&#160;"OnyxSessionId&#160;with&#160;the&#160;following&#160;value:&#160;"&#160;&amp;&#160;strSessionId)</p>
        <p Class="Code" class="code">&#160;&#160;Response.End</p>
    </body>
</html>