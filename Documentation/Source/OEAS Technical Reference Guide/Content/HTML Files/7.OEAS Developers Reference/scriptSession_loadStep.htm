<?xml version="1.0" encoding="utf-8"?>
<html MadCap:timeEstimate="0" MadCap:priority="0" MadCap:status="In Progress" MadCap:lastBlockDepth="6" MadCap:lastHeight="2950.913" MadCap:lastWidth="1918" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../../Resources/TableStyles/Aptean_Note_Table_1.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../Resources/TableStyles/Aptean_Table_1.css" rel="stylesheet" MadCap:stylesheetType="table" />
    </head>
    <body>
        <head><title>loadStep (scriptSession)</title>
            <link href="../../Resources/Stylesheets/ApteanOLH.css" rel="stylesheet" type="text/css" />
        </head>
        <h2>
            <MadCap:keyword term="loadStep" />loadStep method</h2>
        <p>The loadStep method of the <a href="scriptSession_object.htm"><MadCap:keyword term="scriptSession" />scriptSession</a> 
 object retrieves the domain data for a script and possibly transactional 
 data for a scriptSession.</p>
        <h3>Parameters</h3>
        <table style="mc-table-style: url('../../Resources/TableStyles/Aptean_Table_1.css');" class="TableStyle-Aptean_Table_1" cellspacing="0">
            <col class="TableStyle-Aptean_Table_1-Column-Column1" style="width: 4cm;" />
            <col class="TableStyle-Aptean_Table_1-Column-Column1" style="width: 3cm;" />
            <col class="TableStyle-Aptean_Table_1-Column-Column1" style="width: 3cm;" />
            <col class="TableStyle-Aptean_Table_1-Column-Column1" style="width: 3cm;" />
            <col class="TableStyle-Aptean_Table_1-Column-Column1" style="width: 4cm;" />
            <thead>
                <tr class="TableStyle-Aptean_Table_1-Head-Header1">
                    <th class="TableStyle-Aptean_Table_1-HeadE-Column1-Header1">
                        <p class="TableHead" style="margin-bottom: 0;">Parameter</p>
                    </th>
                    <th class="TableStyle-Aptean_Table_1-HeadE-Column1-Header1">
                        <p class="TableHead" style="margin-bottom: 0;">Direction</p>
                    </th>
                    <th class="TableStyle-Aptean_Table_1-HeadE-Column1-Header1">
                        <p class="TableHead" style="margin-bottom: 0;">Data type</p>
                    </th>
                    <th class="TableStyle-Aptean_Table_1-HeadE-Column1-Header1">
                        <p class="TableHead" style="margin-bottom: 0;">Content type</p>
                    </th>
                    <th class="TableStyle-Aptean_Table_1-HeadD-Column1-Header1">
                        <p class="TableHead" style="margin-bottom: 0;">Description</p>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Aptean_Table_1-Body-Body1">
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">scriptSessionId</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">in</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">string</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">n/a</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyD-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Contains the primaryId of the current script 
 session</p>
                    </td>
                </tr>
                <tr class="TableStyle-Aptean_Table_1-Body-Body1">
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">scriptSessionStepId (optional)</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">in</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">string</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">n/a</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyD-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Contains the primaryId of a previously recorded 
 scriptSessionStep</p>
                    </td>
                </tr>
                <tr class="TableStyle-Aptean_Table_1-Body-Body1">
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">scriptStepId (optional)</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">in</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">i4</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">n/a</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyD-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Contains the primaryId of the initial step 
 in a script</p>
                    </td>
                </tr>
                <tr class="TableStyle-Aptean_Table_1-Body-Body1">
                    <td class="TableStyle-Aptean_Table_1-BodyB-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">scriptSessionXml</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyB-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">inOut</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyB-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">string</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyB-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">n/a</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyA-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Contains the <a href="rtx_runtimeXML_book.htm">run-time 
 XML</a></p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h3>Steps</h3>
        <table style="mc-table-style: url('../../Resources/TableStyles/Aptean_Table_1.css');" class="TableStyle-Aptean_Table_1" cellspacing="0">
            <col class="TableStyle-Aptean_Table_1-Column-Column1" style="width: 5cm;" />
            <col class="TableStyle-Aptean_Table_1-Column-Column1" style="width: 5cm;" />
            <col class="TableStyle-Aptean_Table_1-Column-Column1" style="width: 7cm;" />
            <thead>
                <tr class="TableStyle-Aptean_Table_1-Head-Header1">
                    <th class="TableStyle-Aptean_Table_1-HeadE-Column1-Header1">
                        <p class="TableHead" style="margin-bottom: 0;">Step data</p>
                    </th>
                    <th class="TableStyle-Aptean_Table_1-HeadE-Column1-Header1">
                        <p class="TableHead" style="margin-bottom: 0;">Step type</p>
                    </th>
                    <th class="TableStyle-Aptean_Table_1-HeadD-Column1-Header1">
                        <p class="TableHead" style="margin-bottom: 0;">Description</p>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Aptean_Table_1-Body-Body1">
                    <td class="TableStyle-Aptean_Table_1-BodyB-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">OnyxScriptEngineStep.ScriptEngine</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyB-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">com</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyA-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Call the script engine to load a step in 
 a script</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h3>Remarks</h3>
        <p>You can call this method when the application requires no persistence 
 of transactional data such as when starting a new script session or when 
 returning to a previous script step for editing or viewing. The loadStep 
 method does not evaluate any branching rules. When starting a new script 
 session, you must call scriptSession <a href="scriptsession_insert.htm">insert</a> 
 before calling this method in order to pass it the scriptSessionId parameter.</p>
        <p>Either scriptSessionStepId or scriptStepId must be specified in the 
 parameters of a given loadStep call. If you specify both, scriptSessionStepId 
 takes precedence, and the engine returns both transactional and domain 
 data. Specify scriptSessionStepId when the application needs to return 
 to a previous step in a script. If you only specify scriptStepId in the 
 parameters, the engine returns only domain data. You specify only the 
 scriptStepId when you are starting a new script session.</p>
        <p>If you specify only the scriptStepId, the engine performs the following 
 actions:</p>
        <ol>
            <li class="BulletIntro">Gets the script 
 step, prompt, and response domain data from the cache</li>
            <li>Processes pre method calls for the loaded step</li>
            <li>Sets the default value of prompts</li>
            <li>Creates responses</li>
            <li>Merges variables with text in step and prompts</li>
            <li>Removes list variables local to loaded step</li>
        </ol>
        <p>If you specify the scriptSessionStepId, the engine retrieves the transactional 
 data for the specified step before performing the preceding list of actions.</p>
        <h3>Example</h3>
        <p>This example uses a script which does the following:</p>
        <ol>
            <li>Uses a script that prompts the user to search 
 the database for the ID of a caller.</li>
            <li>Asks if the user wants to continue or end the 
 script.</li>
            <li>If the user chooses to continue, the script asks 
 them if they want to enter an incident for the caller. The user can choose 
 to enter an incident or end the script.</li>
            <li>If the user chooses to enter an incident, the 
 script displays the new incident ID.</li>
            <li>In the final step, displays the caller's ID and 
 the new incident ID.</li>
        </ol>
        <p>The following example XML shows a loadStep call to start a new script 
 session. Because this is a new session, the caller passes in the scriptSessionId, 
 scriptStepId, and scriptSessionXml. At this point the run-time XML contains 
 only the context variables for the script session.</p>
        <table style="mc-table-style: url('../../Resources/TableStyles/Aptean_Note_Table_1.css');width: 80%;" class="TableStyle-Aptean_Note_Table_1" cellspacing="2">
            <col style="width: 0.7cm;" class="TableStyle-Aptean_Note_Table_1-Column-Column1" />
            <col class="TableStyle-Aptean_Note_Table_1-Column-Column1" style="width: 15.50cm;" />
            <tbody>
                <tr class="TableStyle-Aptean_Note_Table_1-Body-Body1">
                    <td class="TableStyle-Aptean_Note_Table_1-BodyB-Column1-Body1" style="text-align: right;">
                        <p>
                            <img src="../../Resources/Images/Common/note_image.png" />
                        </p>
                    </td>
                    <td class="TableStyle-Aptean_Note_Table_1-BodyA-Column1-Body1">
                        <p class="TableText"><b>Note</b>: For better readability, whitespace was added to the scriptSessionXml. 
 In practice, this might not contain any whitespace.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>
            Parameters
        </p>
        <p Class="Code" class="code">&lt;parameters&gt;</p>
        <p Class="Code" class="code">&#160;&lt;scriptSessionId&gt;88515B97-9961-4DD9-8104-18F8B4FD7F7A&lt;/scriptSessionId&gt;</p>
        <p Class="Code" class="code">&#160;&lt;scriptSessionStepId/&gt;</p>
        <p Class="Code" class="code">&#160;&lt;scriptStepId&gt;100006&lt;/scriptStepId&gt;</p>
        <p Class="Code" class="code">&#160;&lt;scriptSessionXml&gt;</p>
        <p Class="Code" class="code">&lt;root&gt;</p>
        <p Class="Code" class="code">&#160;&lt;script&#160;primaryId="100002"&#160;initialStepId="100006"&gt;&lt;/script&gt;</p>
        <p Class="Code" class="code">&#160;&lt;variables&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;variable&#160;name="_ownerid"&#160;type="scalar"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&lt;item&#160;text="348A16DB-77AA-4A61-B9AF-8A0A5C85C285"&#160;code="348A16DB-77AA-4A61-B9AF-8A0A5C85C285"&gt;&lt;/item&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;/variable&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;variable&#160;name="_ownertype"&#160;type="scalar"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&lt;item&#160;text="2"&#160;code="2"&gt;&lt;/item&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;/variable&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;variable&#160;name="_ownername"&#160;type="scalar"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&lt;item&#160;text="Porter&#160;Power&#160;Washer"&#160;code="Porter&#160;Power&#160;Washer"&gt;&lt;/item&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;/variable&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;variable&#160;name="_userid"&#160;type="scalar"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&lt;item&#160;text="System&#160;Administrator"&#160;code="sa"&gt;&lt;/item&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;/variable&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;variable&#160;name="_scriptsessionid"&#160;type="scalar"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&lt;item&#160;text="88515B97-9961-4DD9-8104-18F8B4FD7F7A"&#160;code="88515B97-9961-4DD9-8104-18F8B4FD7F7A"&gt;&lt;/item&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;/variable&gt;</p>
        <p Class="Code" class="code">&#160;&lt;/variables&gt;</p>
        <p Class="Code" class="code">&lt;/root&gt;</p>
        <p Class="Code" class="code">&#160;&lt;/scriptSessionXml&gt;</p>
        <p Class="Code" class="code">&lt;/parameters&gt;</p>
        <p>The loadStep method returns run-time XML containing script and variables 
 nodes. The script node contains the step, prompt, and response domain 
 data necessary for rendering the "identifyCaller" script step 
 in the user interface. Because this is the first step of a new script, 
 the variables collection is unchanged.</p>
        <p>
            parametersReturn
        </p>
        <p Class="Code" class="code">&lt;parametersReturn&gt;</p>
        <p Class="Code" class="code">&#160;&lt;scriptSessionXml&gt;</p>
        <p Class="Code" class="code">&lt;root&gt;</p>
        <p Class="Code" class="code">&#160;&lt;script&#160;primaryId="100002"&#160;initialStepId="100006"&#160;loadedScriptStepId="100006"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;scriptSteps&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&lt;scriptStep&#160;primaryId="100006"&#160;name="identifyCaller"&#160;description="Find&#160;the&#160;ID&#160;of&#160;the&#160;caller&#160;in&#160;the&#160;database&#160;and&#160;store&#160;it&#160;in&#160;a&#160;variable&#160;to&#160;use&#160;in&#160;a&#160;subsequent&#160;incident&#160;insert"&#160;headerText="&amp;amp;lt;h1&amp;amp;gt;Find&#160;the&#160;caller's&#160;ID&#160;in&#160;our&#160;database&amp;amp;lt;/h1&amp;amp;gt;"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&lt;scriptPrompts&#160;collection="1"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&lt;scriptPrompt&#160;primaryId="100003"&#160;controlTypeCode="customerSearch"&#160;text="Find&#160;the&#160;ID&#160;of&#160;the&#160;caller:"/&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&lt;scriptPrompt&#160;primaryId="100004"&#160;sortResponsesInUi="1"&#160;controlTypeCode="radioButtonSet"&#160;text="Continue&#160;to&#160;incident&#160;insert&#160;or&#160;end&#160;now?"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&lt;scriptPromptResponses&#160;collection="1"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;scriptPromptResponse&#160;responseCode="continueYes"&#160;text="Continue"/&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&lt;scriptPromptResponse&#160;responseCode="continueNo"&#160;text="End&#160;now"/&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&#160;&lt;/scriptPromptResponses&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&#160;&lt;/scriptPrompt&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&#160;&lt;/scriptPrompts&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&lt;/scriptStep&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;/scriptSteps&gt;</p>
        <p Class="Code" class="code">&#160;&lt;/script&gt;</p>
        <p Class="Code" class="code">&#160;&lt;variables&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;variable&#160;name="_ownerid"&#160;type="scalar"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&lt;item&#160;text="348A16DB-77AA-4A61-B9AF-8A0A5C85C285"&#160;code="348A16DB-77AA-4A61-B9AF-8A0A5C85C285"&gt;&lt;/item&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;/variable&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;variable&#160;name="_ownertype"&#160;type="scalar"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&lt;item&#160;text="2"&#160;code="2"&gt;&lt;/item&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;/variable&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;variable&#160;name="_ownername"&#160;type="scalar"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&lt;item&#160;text="Porter&#160;Power&#160;Washer"&#160;code="Porter&#160;Power&#160;Washer"&gt;&lt;/item&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;/variable&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;variable&#160;name="_userid"&#160;type="scalar"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&lt;item&#160;text="System&#160;Administrator"&#160;code="sa"&gt;&lt;/item&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;/variable&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;variable&#160;name="_scriptsessionid"&#160;type="scalar"&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&#160;&lt;item&#160;text="100005"&#160;code="100005"&gt;&lt;/item&gt;</p>
        <p Class="Code" class="code">&#160;&#160;&lt;/variable&gt;</p>
        <p Class="Code" class="code">&#160;&lt;/variables&gt;</p>
        <p Class="Code" class="code">&lt;/root&gt;</p>
        <p Class="Code" class="code">&#160;&lt;/scriptSessionXml&gt;</p>
        <p Class="Code" class="code">&lt;/parametersReturn&gt;</p>
    </body>
</html>