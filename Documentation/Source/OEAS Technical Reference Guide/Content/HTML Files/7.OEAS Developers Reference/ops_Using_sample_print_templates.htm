<?xml version="1.0" encoding="utf-8"?>
<html MadCap:check_list="Ran Smart Index" MadCap:timeEstimate="0" MadCap:priority="0" MadCap:status="In Progress" MadCap:lastBlockDepth="6" MadCap:lastHeight="1655.165" MadCap:lastWidth="1102" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../../Resources/TableStyles/Aptean_Note_Table_1.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../Resources/TableStyles/Aptean_Table_1.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../Resources/Stylesheets/ApteanOLH.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <head><title>Using sample print templates (OPS)</title>
            <link href="../../Resources/Stylesheets/ApteanOLH.css" rel="stylesheet" type="text/css" />
        </head>
        <h4>
            <MadCap:keyword term="templates" />
            <MadCap:keyword term="Using sample print templates" />Using sample print templates</h4>
        <p>
            <MadCap:keyword term="OPS" />Onyx Processing Server (OPS) includes sample print templates that you 
 can use as is or modify for your customization. These templates demonstrate 
 various types of printed literature products. The OPS setup installs the 
 templates on the OPS server with the file names given in the following 
 table.</p>
        <p>By default, OPS Setup places the following templates in C:\Program Files\Onyx\ProcessingServer\Document 
 Templates.</p>
        <h3>Sample print templates</h3>
        <table style="mc-table-style: url('../../Resources/TableStyles/Aptean_Table_1.css');" class="TableStyle-Aptean_Table_1" cellspacing="0">
            <col class="TableStyle-Aptean_Table_1-Column-Column1" style="width: 5cm;" />
            <col class="TableStyle-Aptean_Table_1-Column-Column1" style="width: 12cm;" />
            <col class="TableStyle-Aptean_Table_1-Column-Column1" style="width: 12cm;" />
            <thead>
                <tr class="TableStyle-Aptean_Table_1-Head-Header1">
                    <th class="TableStyle-Aptean_Table_1-HeadE-Column1-Header1">
                        <p class="TableHead" style="margin-bottom: 0;">Template type</p>
                    </th>
                    <th class="TableStyle-Aptean_Table_1-HeadE-Column1-Header1">
                        <p class="TableHead" style="margin-bottom: 0;">Description</p>
                    </th>
                    <th class="TableStyle-Aptean_Table_1-HeadD-Column1-Header1">Print Template File</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Aptean_Table_1-Body-Body1">
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Plain</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Plain text that requires no data merging</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyD-Column1-Body1">OPSPlain.docx</td>
                </tr>
                <tr class="TableStyle-Aptean_Table_1-Body-Body1">
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Data Insert</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Plain text with simple data merging</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyD-Column1-Body1">OPSDataInsert.docx</td>
                </tr>
                <tr class="TableStyle-Aptean_Table_1-Body-Body1">
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Batch report</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Batch report listing all order lines within 
 a batch</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyD-Column1-Body1">OPSBatchReport.docx</td>
                </tr>
                <tr class="TableStyle-Aptean_Table_1-Body-Body1">
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Order report</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyE-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Example order report with order header data 
 and order item summary</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyD-Column1-Body1">OPSOrderReport.docx</td>
                </tr>
                <tr class="TableStyle-Aptean_Table_1-Body-Body1">
                    <td class="TableStyle-Aptean_Table_1-BodyB-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Label</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyB-Column1-Body1">
                        <p class="TableText" style="margin-bottom: 0;">Multiple label instances printed per page 
 of output (example formatted for the Avery 5163 label)</p>
                    </td>
                    <td class="TableStyle-Aptean_Table_1-BodyA-Column1-Body1">OPSLabel.docx</td>
                </tr>
            </tbody>
        </table>
        <table style="mc-table-style: url('../../Resources/TableStyles/Aptean_Note_Table_1.css');width: 80%;" class="TableStyle-Aptean_Note_Table_1" cellspacing="2">
            <col style="width: 0.7cm;" class="TableStyle-Aptean_Note_Table_1-Column-Column1" />
            <col class="TableStyle-Aptean_Note_Table_1-Column-Column1" style="width: 15.50cm;" />
            <tbody>
                <tr class="TableStyle-Aptean_Note_Table_1-Body-Body1">
                    <td class="TableStyle-Aptean_Note_Table_1-BodyB-Column1-Body1" style="text-align: right;">
                        <p>
                            <img src="../../Resources/Images/Common/note_image.png" />
                        </p>
                    </td>
                    <td class="TableStyle-Aptean_Note_Table_1-BodyA-Column1-Body1">
                        <p class="TableText"><b>Note</b>: The Batch report and Order report are examples of system 
 documents.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>The data is merged into the document using GemBox document dll (http://www.gemboxsoftware.com/document/overview) by Mail Merge feature of OPEN XML. GemBox.Document requires only .NET Framework. The OPS print engine:</p>
        <ul>
            <li>Instantiates Gembox document object</li>
            <li>Opens the Word document specified by the literature product.</li>
            <li>Calls the MailMerge Execute method of GemBox to produce the final document for printing. </li>
        </ul>
        <h4>Plain templates</h4>
        <p>Plain templates contain only literal text and do not contain the Mail Merge fields , therefore no substitutions are performed from the orderBatch XML data, and they are printed literally as written.</p>
        <h4>Data insert templates</h4>
        <p>Data Insert templates are the simplest form of data merging. Data substitution locations are indicated in the template by using the Mail Merge fields with field name such as DataTableName_columnName. For example you can create data insert template by using <code>{MERGEFIELD literatureOrder_shipToAddress6 \* MERGEFORMAT}</code>  or by using Mail Merge field creation option. GemBox mailmerge Execute method replaces these mail merge fields with relevant data from the data source. For more information, refer to <a href="http://www.gemboxsoftware.com/SampleExplorer/Document/list/MailMerge"><span class="Hyperlink">http://www.gemboxsoftware.com/SampleExplorer/Document/list/MailMerge</span></a>.</p>
        <h4>Batch report templates</h4>
        <p>A Batch report template is similar to simple Data insert templates. However, the data substitution is performed for multiple items, such as multiple order items within an order batch. The data filled to this document is from a de-normalized table consisting of literatureOrder, literatureOrderLine, and literatureOrderBatch nodes data (refer -OrderBatchPrintSample.xml file).</p>
        <p>An example of this type of template is a pick-list, where each row of the report provides summary information for each literature product contained in the order.</p>
        <h4>Order report templates</h4>
        <p>An Order report template can be regarded as a combination of a Data insert (Normalized tables) and Batch report template (De-normalized tables). The Order report template incorporates individual order information as well as a summary list of order items.</p>
        <h4>Label templates</h4>
        <p>Label templates are a special case where individual order items of the same product type are printed together. This conserves the label printing media by enabling multiple labels to be printed on a sheet of label stock. When a literature order contains any products that you classify as labels, the print engine invokes label template processing. This processing proceeds as follows:</p>
        <ol style="list-style-type: decimal;margin-left: 36pt;" start="1">
            <li>When a Label product is encountered in the course of processing an order batch, GemBox performs the data substitutions, as previously described, for all of the order and queues to the printer.</li>
            <li>The Print Engine inserts the product ID for this Label product into a list that represents order items that have been processed.</li>
            <li>When the Print Engine encounters another order item for a label product, it checks the list to determine if that product has already been processed. If so, the Print Engine skips that order item. If the item has not yet been processed, the Print Engine processing continues at Step 1.</li>
            <li>The Print Engine processing continues until all order items, whether or not they are label products, are processed.</li>
        </ol>
        <h3 class="ElementHeader" MadCap:conditions="Default.Obsolete"><a name="opsDataPath"></a>opsDataPath Usage</h3>
        <p class="BodyText" MadCap:conditions="Default.Obsolete">The opsDataPath keyword identifies placeholders for information to be 
 inserted into the template. The placeholder includes an Xpath declaration. 
 You can look at the sample print templates to see the format of the placeholders.</p>
        <p class="BodyText" MadCap:conditions="Default.Obsolete">The OPSProcessDocument function 
 inserts the order information in the locations indicated by the opsDataPath 
 keywords contained within the Print template. Refer to <a href="ops_Custom_Word_Document_Templates.htm#OPSProcessDocument_implementation">OPSProcessDocument 
 implementation</a> for the details of how the substitutions are performed.</p>
        <p class="BodyText" MadCap:conditions="Default.Obsolete">The VBA code associated with these templates include the OnyxProcessDocument 
 function. The print subsystem passes a reference to an IXMLDOMNode, with 
 the context node being a literatureOrderLine, containing orderBatch XML 
 to the function. You can reference any data in the orderBatch XML with 
 the appropriate XPath expression.</p>
        <p class="BodyText" MadCap:conditions="Default.Obsolete">The previous template uses XPath shorthand, "../../" to reference 
 data from the parent literatureOrder of the current literatureOrderLine 
 node passed to the OnyxProcessDocument function.</p>
    </body>
</html>