<!-- Copyright Aptean 2017. All rights reserved. -->
<rules xmlns="http://www.consonacrm.com/brm"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xsi:schemaLocation="http://www.consonacrm.com/brm ../grammar/onyx/businessRuleManager.grammar.onyx.xsd"
	description="TEST rule set for web service calls">
	<rule description="Test external public Web Service calls">
		<webServiceCall description="Call GetAustralianPostCodeByLocation using WebServiceX public webservice">
			<wsdl>
				<literal>http://www.webservicex.net/AustralianPostCode.asmx?WSDL</literal>
			</wsdl>
			<service>
				<literal>AustralianPostCode</literal>
			</service>
			<method>
				<literal>GetAustralianPostCodeByLocation</literal>
			</method>
			<inputParameters description="Add parameters for location">
				<addNode>
					<path>
						<literal>.</literal>
					</path>
					<name>
						<literal>GetAustralianPostCodeByLocation</literal>
					</name>
				</addNode>
				<addNode>
					<path>
						<literal>GetAustralianPostCodeByLocation</literal>
					</path>
					<name>
						<literal>Location</literal>
					</name>
				</addNode>
				<setNodeValue>
					<path>
						<literal>GetAustralianPostCodeByLocation/Location</literal>
					</path>
					<value>
						<literal>Bribbaree</literal>
					</value>
				</setNodeValue>
			</inputParameters>
			<outputParameters description="Save result to return parameters">
				<addNode>
					<path>
						<literal>//parametersReturn</literal>
					</path>
					<name>
						<literal>LocationByPostCode</literal>
					</name>
				</addNode>
				<setNodeXML>
					<path>
						<literal>//parametersReturn/LocationByPostCode</literal>
					</path>
					<value>
						<getNodeValue>
							<literal>descendant::*[name()='GetAustralianPostCodeByLocationResult']</literal>
						</getNodeValue>
					</value>
				</setNodeXML>
			</outputParameters>
		</webServiceCall>
		<webServiceCall description="Call GetQuote using WebServiceX public webservice">
			<wsdl>
				<literal>http://www.webservicex.net/stockquote.asmx?WSDL</literal>
			</wsdl>
			<service>
				<literal>StockQuote</literal>
			</service>
			<method>
				<literal>GetQuote</literal>
			</method>
			<inputParameters description="Add parameters for stock ticker">
				<addNode>
					<path>
						<literal>.</literal>
					</path>
					<name>
						<literal>GetQuote</literal>
					</name>
				</addNode>
				<addNode>
					<path>
						<literal>GetQuote</literal>
					</path>
					<name>
						<literal>symbol</literal>
					</name>
				</addNode>
				<setNodeValue>
					<path>
						<literal>GetQuote/symbol</literal>
					</path>
					<value>
						<literal>MSFT</literal>
					</value>
				</setNodeValue>
			</inputParameters>
			<outputParameters description="Save result to return parameters">
				<addNode>
					<path>
						<literal>//parametersReturn</literal>
					</path>
					<name>
						<literal>StockQuote</literal>
					</name>
				</addNode>
				<setNodeXML>
					<path>
						<literal>//parametersReturn/StockQuote</literal>
					</path>
					<value>
						<getNodeValue>
							<literal>descendant::*[name()='GetQuoteResult']</literal>
						</getNodeValue>
					</value>
				</setNodeXML>
			</outputParameters>
		</webServiceCall>
		<webServiceCall description="Call ConversionRate using WebServiceX public webservice">
			<wsdl>
				<literal>http://www.webservicex.net/CurrencyConvertor.asmx?WSDL</literal>
			</wsdl>
			<service>
				<literal>CurrencyConvertor</literal>
			</service>
			<method>
				<literal>ConversionRate</literal>
			</method>
			<inputParameters description="Add parameters to establish session">
				<addNode>
					<path>
						<literal>.</literal>
					</path>
					<name>
						<literal>ConversionRate</literal>
					</name>
				</addNode>
				<addNode>
					<path>
						<literal>ConversionRate</literal>
					</path>
					<name>
						<literal>FromCurrency</literal>
					</name>
				</addNode>
				<addNode>
					<path>
						<literal>ConversionRate</literal>
					</path>
					<name>
						<literal>ToCurrency</literal>
					</name>
				</addNode>
				<setNodeValue>
					<path>
						<literal>ConversionRate/FromCurrency</literal>
					</path>
					<value>
						<literal>AUD</literal>
					</value>
				</setNodeValue>
				<setNodeValue>
					<path>
						<literal>ConversionRate/ToCurrency</literal>
					</path>
					<value>
						<literal>USD</literal>
					</value>
				</setNodeValue>
			</inputParameters>
			<outputParameters description="Save result to return parameters">
				<addNode>
					<path>
						<literal>//parametersReturn</literal>
					</path>
					<name>
						<literal>AUDtoUSD</literal>
					</name>
				</addNode>
				<setNodeXML>
					<path>
						<literal>//parametersReturn/AUDtoUSD</literal>
					</path>
					<value>
						<getNodeValue>
							<literal>descendant::*[name()='ConversionRateResult']</literal>
						</getNodeValue>
					</value>
				</setNodeXML>
			</outputParameters>
		</webServiceCall>
	</rule>
	<rule description="Test HTTP calls using local Onyx web services">
		<addNode>
			<path>
				<literal>//parametersReturn</literal>
			</path>
			<name>
				<literal>httpGetContent</literal>
			</name>
			<value>
				<httpGet>
					<url>
						<literal>http://localhost/oeasauth_onyx/service.asmx?WSDL</literal>
					</url>
				</httpGet>
			</value>
		</addNode>
		<addNode>
			<path>
				<literal>//parametersReturn</literal>
			</path>
			<name>
				<literal>httpPostContent</literal>
			</name>
			<value>
				<httpPost>
					<url>
						<literal>http://localhost/oeasauth_onyx/service.asmx/EstablishSession</literal>
					</url>
					<contentType>
						<literal>application/x-www-form-urlencoded</literal>
					</contentType>
					<content>
						<literal>OnyxUserName=sa&amp;Password=onyx123&amp;ApplicationName=Test&amp;SourceName=Test&amp;SiteID=1</literal>
					</content>
				</httpPost>
			</value>
		</addNode>
	</rule>
</rules>
